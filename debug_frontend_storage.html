<!DOCTYPE html>
<html>
<head>
    <title>Debug Frontend Storage</title>
</head>
<body>
    <h1>Frontend Storage Debug Tool</h1>
    
    <h2>Current localStorage</h2>
    <div id="localStorage-content"></div>
    
    <h2>Actions</h2>
    <button onclick="showLocalStorage()">Refresh localStorage</button>
    <button onclick="clearTargetLibrary()">Clear target_library</button>
    <button onclick="clearAll()">Clear All localStorage</button>
    
    <h2>Set target_library</h2>
    <input type="text" id="newTarget" placeholder="Enter library name">
    <button onclick="setTargetLibrary()">Set</button>
    
    <script>
        function showLocalStorage() {
            const content = document.getElementById("localStorage-content");
            let html = "<table border=\"1\"><tr><th>Key</th><th>Value</th></tr>";
            
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                const value = localStorage.getItem(key);
                html += `<tr><td>${key}</td><td>${value}</td></tr>`;
            }
            
            html += "</table>";
            content.innerHTML = html;
            
            console.log("=== localStorage contents ===");
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                const value = localStorage.getItem(key);
                console.log(`${key}: ${value}`);
            }
        }
        
        function clearTargetLibrary() {
            localStorage.removeItem("target_library");
            showLocalStorage();
            console.log("Cleared target_library");
        }
        
        function clearAll() {
            localStorage.clear();
            showLocalStorage();
            console.log("Cleared all localStorage");
        }
        
        function setTargetLibrary() {
            const newValue = document.getElementById("newTarget").value;
            if (newValue) {
                localStorage.setItem("target_library", newValue);
                showLocalStorage();
                console.log(`Set target_library to: ${newValue}`);
            }
        }
        
        // Auto-refresh on load
        window.onload = showLocalStorage;
    </script>
</body>
</html>
